{% extends 'nasa_app/base.html' %}
{% load static %}

{% block title %}Multi-Satellite Tracker{% endblock %}

{% block styles %}
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<link rel="stylesheet" href="{% static 'css/iss_tracker.css' %}">
{% endblock %}

{% block content %}
<div class="iss-container">
  <h2>üõ∞Ô∏è Real-Time Satellite Tracker</h2>

  <select id="satellite-select">
  <optgroup label="üõ∞Ô∏è Space Stations">
    <option value="25544">ISS (25544)</option>
    <option value="41765">Tiangong Space Station (41765)</option>
  </optgroup>

  <optgroup label="üåç Earth Observation">
    <option value="25994">Terra (25994)</option>
    <option value="39084">Landsat 8 (39084)</option>
    <option value="33591">OCEANSAT-2 (33591)</option>
    <option value="40926">RESOURCESAT-2A (40926)</option>
    <option value="39086">SARAL (39086)</option>
    <option value="43013">NOAA 20 (43013)</option>
    <option value="25338">SPOT 4 (25338)</option>
  </optgroup>

  <optgroup label="üõ∞Ô∏è Scientific & Space Telescopes">
    <option value="20580">Hubble Space Telescope (20580)</option>
    <option value="36122">SWIFT Gamma-Ray Burst Explorer (36122)</option>
    <option value="27370">CHANDRA X-Ray Observatory (27370)</option>
  </optgroup>

  <optgroup label="‚òÅÔ∏è Meteorological">
    <option value="40938">INSAT-3DR (40938)</option>
    <option value="42930">MetOp-C (42930)</option>
    <option value="27424">FENGYUN 1C (27424)</option>
  </optgroup>

  <optgroup label="üì° Communication & Navigation">
    <option value="40935">GSAT-18 (40935)</option>
    <option value="43226">GSAT-31 (43226)</option>
    <option value="43241">GSAT-30 (43241)</option>
    <option value="41866">IRNSS-1I (41866)</option>
  </optgroup>
</select>


  <div id="map" class="map-container"></div>

  <div class="info-panel">
    <p><strong>Latitude:</strong> <span id="lat-display">{{ initial_lat }}</span></p>
    <p><strong>Longitude:</strong> <span id="lon-display">{{ initial_lon }}</span></p>
    <p class="note">Updated every 5 seconds for selected satellite.</p>
  </div>
</div>

<div class="pass-section">
  <h3>üî≠ Find Next Satellite Pass Over Your Location</h3>
  <form id="pass-form">
    <label>
      City / Place:
      <input type="text" id="place-input" placeholder="e.g. Delhi">
    </label>
    <label>
      Latitude:
      <input type="number" step="any" id="pass-lat" placeholder="e.g. 28.6139" required>
    </label>
    <label>
      Longitude:
      <input type="number" step="any" id="pass-lon" placeholder="e.g. 77.2090" required>
    </label>
    <button type="button" id="locate-me">üìç Use My Location</button>
    <button type="submit">Get Pass Times</button>
  </form>

  <div id="pass-results" class="pass-results scroll-box">
    <div class="spinner" style="display: none;">Loading...</div>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
  const initialLat = parseFloat("{{ initial_lat }}");
  const initialLon = parseFloat("{{ initial_lon }}");
  const N2YO_API_KEY = "{{ n2yo_api_key }}";
</script>
<script src="{% static 'js/iss_tracker.js' %}"></script>
{% endblock %}
